# weebi dart grpc server

## test it
grpcurl -proto packages\protos\proto\weebi_app_service.proto dev.weebicom:443 weebi.weebi_app.service.WeebiAppService/readAppMinimumVersion
> for more see file `_curls.md`

> for kreya (postman like) see folder `kreya_api_calling`

## run locally

install mongosh

```shell
dart pub global activate melos
melos bootstrap
cd app/server
dart bin/server_local.dart
```

## run in dev/prod
```shell
$env:MONGO_DB_URI="your_mongodb_connection_string_here"
$env:PORT="8080"
$env:HTTP_PORT="8081"
dart run apps/server/bin/server.dart
```

## troubleshoot
if mongodb MongoServerSelectionError: connect ETIMEDOUT 

In Windows Defender Firewall
Go to Outbound Rules â†’ New Rule.
Select Port, click Next.
Choose TCP, specify 27017, click Next.
Select Allow the connection, click Next.
Apply to all profiles (Domain, Private, Public), click Next.
Name it something like MongoDB Outbound, click Finish.

Platform.environment : 
['ENVIRONMENT'] -- 'production' or 'development'
['PORT'] -- gRPC server port (default: 8080)
['HTTP_PORT'] -- HTTP REST server port for email callbacks (default: 8081)
['HTTP_BASE_URL'] -- Base URL for email links (e.g. https://prd.weebi.com)
['MONGO_DB_URI']
['JWT_SECRET_KEY']

optional : 
['FROM_EMAIL'] ?? 'hello@weebi.com';
['FROM_NAME'] ?? 'Weebi';

['MAILTRAP_DEV_USERNAME'];
['MAILTRAP_DEV_PASSWORD'];