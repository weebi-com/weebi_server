syntax = "proto3";

package weebi.chain;

import "boutique.proto";
import "common/g_timestamp.proto";
import "common/mongo.proto";

/// a Chain, Cha√Æne de magasins  
/// is a group of boutiques that share the same article catalog and contact directory
/// by default a firm has one chain with one boutique

// devices are handled at the chains level, not the boutiques

message Chain {
  string chainId = 1 [json_name = 'chainId'];
  string firmId = 2 [json_name = 'firmId'];
  string name = 3 [json_name = 'name'];
  repeated weebi.boutique.Boutique boutiques = 4 [json_name = 'boutiques'];
  repeated Device devices = 5 [json_name = 'devices'];
  google.protobuf.Timestamp lastUpdateTimestampUTC = 6 [json_name = 'lastUpdateTimestampUTC'];;
  string lastUpdatedByuserId = 7 [json_name = 'lastUpdatedByuserId'];
}

message Chains {
  repeated Chain chains = 1 [json_name = 'chains']; 
}

/// a Device == cash register, assigned to a chain, it can be used by each chain's boutiques
/// it is assigned to a boutique by default with easy access so that the cashier can always log in 
message Device {
  string _id = 1 [json_name = '_id'];
  string chainId = 2 [json_name = 'chainId'];
  string boutiqueId = 3 [json_name = 'boutiqueId'];
  bool status = 4 [json_name = 'status'];
  string password = 5 [json_name = 'password'];
  // below comes from device
  string name = 6 [json_name = 'name'];
  string serialNumber = 7 [json_name = 'serialNumber'];
  string baseOS = 8 [json_name = 'baseOS'];
  string brand = 9 [json_name = 'brand'];
}

message Devices {
  repeated Device devices = 1 [json_name = 'devices']; 
}

// boutique A : food - chain 1
// boutique B : beauty - chain 2
// boutique C : cosmetics - chain 3

// boutique B & C merge (acquisition or in fact belang to the same compagny all along)
// boutique C now belongs to chain 2

// boutique A : alimentation - chain 1
// boutique B : beauty - chain 2
// boutique C : cosmetics - chain 2
